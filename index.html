<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Email Sorter</title>
<style>
:root {
  --bg: #f4f6fb;
  --card-bg: #fff;
  --primary: #4a90e2;
  --text: #333;
  --radius: 14px;
  --shadow: 0 4px 20px rgba(0,0,0,0.08);
}
body {
  font-family: 'Inter', Arial, sans-serif;
  background: var(--bg);
  color: var(--text);
  display: flex;
  justify-content: center;
  padding: 20px;
  margin: 0;
  transition: background 0.3s, color 0.3s;
}
.container {
  background: var(--card-bg);
  border-radius: var(--radius);
  box-shadow: var(--shadow);
  padding: 30px;
  width: 100%;
  max-width: 700px;
  transition: background 0.3s, color 0.3s;
  position: relative;
}
h1 { font-size: 1.8rem; text-align: center; color: var(--primary); margin-bottom: 10px; }
h2 { color: var(--primary); margin-top: 20px; }
p { margin-bottom: 10px; }
textarea {
  width: 100%;
  height: clamp(120px, 25vh, 240px);
  border-radius: var(--radius);
  border: 1px solid #ddd;
  padding: 12px;
  font-family: monospace;
  font-size: 14px;
  resize: vertical;
  box-sizing: border-box;
  margin-bottom: 15px;
  transition: background 0.3s, color 0.3s, border-color 0.3s;
}
textarea:focus {
  outline: none;
  border-color: var(--primary);
  box-shadow: 0 0 0 2px rgba(74,144,226,0.2);
}
.button-group {
  display: flex;
  justify-content: center;
  flex-wrap: wrap;
  gap: 10px;
  margin-bottom: 15px;
}
button {
  background: var(--primary);
  color: #fff;
  border: none;
  padding: 10px 20px;
  border-radius: var(--radius);
  cursor: pointer;
  font-size: 15px;
  transition: background 0.25s, transform 0.15s;
}
button:hover { background: #357abd; transform: translateY(-1px); }
button.secondary { background: #eee; color: #333; }
button.secondary:hover { background: #ddd; }
.warning { color: #d9534f; text-align: center; margin-bottom: 10px; font-weight: bold; }
footer { text-align: center; font-size: 13px; color: #888; margin-top: 20px; }
.ad-placeholder { text-align:center; margin:15px 0; padding: 10px; background:#eef; border-radius:8px; font-size:14px; color:#555; transition: background 0.3s, color 0.3s; }

/* Night mode */
body.night-mode {
  background: #1e1e2f;
  color: #ddd;
}
body.night-mode .container {
  background: #2a2a3d;
  color: #ddd;
}
body.night-mode textarea {
  background: #3a3a4f;
  color: #eee;
  border-color: #555;
}
body.night-mode button {
  background: #4a90e2;
  color: #fff;
}
body.night-mode button.secondary {
  background: #555;
  color: #ddd;
}
body.night-mode .ad-placeholder {
  background: #444;
  color: #bbb;
}
body.night-mode .warning {
  color: #f28b82;
}

/* Night mode toggle switch with icons */
.toggle-container {
  position: absolute;
  top: 12px;
  right: 12px;
  display: flex;
  align-items: center;
  gap: 6px;
  font-size: 18px;
}
.switch {
  position: relative;
  width: 50px;
  height: 28px;
}
.switch input {
  opacity: 0;
  width: 0;
  height: 0;
}
.slider {
  position: absolute;
  cursor: pointer;
  top: 0; left: 0;
  right: 0; bottom: 0;
  background-color: #ccc;
  transition: 0.4s;
  border-radius: 6px;
}
.slider:before {
  position: absolute;
  content: "";
  height: 22px;
  width: 22px;
  left: 3px;
  bottom: 3px;
  background-color: white;
  transition: 0.4s;
  border-radius: 4px;
}
input:checked + .slider {
  background-color: #4a90e2;
}
input:checked + .slider:before {
  transform: translateX(22px);
}
</style>
</head>
<body>
<div class="container">
  <div class="toggle-container">
    <span id="toggleIcon">üåô</span>
    <label class="switch">
      <input type="checkbox" id="nightModeToggle" onchange="toggleNightModeSwitch()">
      <span class="slider"></span>
    </label>
  </div>

  <h1>üìß Email Sorter</h1>
  <p>Welcome to the Email Sorter! This simple web tool helps you quickly organize, sort, and clean your email lists.</p>
  <div class="ad-placeholder">Ad space</div>

  <h2>How to Use</h2>
  <p>1. Paste your email list into the input box below.</p>
  <p>2. The sorter automatically removes Outlook-style names like <code>"John Doe" &lt;john.doe@email.com&gt;</code> when sorting.</p>
  <p>3. Use the buttons below to <strong>sort</strong>, <strong>remove duplicates</strong>, <strong>copy</strong>, or <strong>clear output</strong>.</p>

  <div class="warning" id="warning"></div>

  <textarea id="input" placeholder="Paste your emails here..."></textarea>

  <div class="button-group">
    <button onclick="sortEmails()">Sort Alphabetically</button>
    <button onclick="removeDuplicates()">Remove Duplicates</button>
    <button class="secondary" onclick="copyOutput()">Copy Output</button>
    <button class="secondary" onclick="clearOutput()">Clear Output</button>
  </div>

  <textarea id="output" placeholder="Your sorted emails appear here..."></textarea>

  <h2>FAQs</h2>
  <p><strong>Q: Can I paste thousands of emails?</strong><br>A: Yes! The tool warns if your list exceeds 5000 emails.</p>
  <p><strong>Q: Does it work with Outlook exports?</strong><br>A: Yes! It automatically cleans up names during sorting.</p>
  <p><strong>Q: Can I use this offline?</strong><br>A: Yes! Everything runs in your browser; no data leaves your device.</p>

  <footer>Made with ‚ù§Ô∏è by You ‚Äî Works offline, no data leaves your browser.</footer>
</div>

<script>
document.addEventListener('DOMContentLoaded', () => {
  const nightMode = localStorage.getItem('nightMode') === 'true';
  if (nightMode) {
    document.body.classList.add('night-mode');
    document.getElementById('nightModeToggle').checked = true;
    document.getElementById('toggleIcon').textContent = '‚òÄÔ∏è';
  }
});

function toggleNightModeSwitch() {
  const isNight = document.getElementById('nightModeToggle').checked;
  document.body.classList.toggle('night-mode', isNight);
  localStorage.setItem('nightMode', isNight);
  document.getElementById('toggleIcon').textContent = isNight ? '‚òÄÔ∏è' : 'üåô';
}

// Get emails from output if exists, else input (and clean Outlook names)
function getCurrentEmails() {
  const outputText = document.getElementById('output').value.trim();
  if (outputText) return outputText.split(/\r?\n/).filter(Boolean);

  const raw = document.getElementById('input').value;
  const cleaned = raw
    .replace(/"[^"]*"\s*<([^>]+)>/g, '$1')
    .replace(/\b[\w\s]+\s*<([^>]+)>/g, '$1')
    .replace(/[<>"]/g, '')
    .replace(/;/g, ' ')
    .replace(/\s+/g, ' ')
    .trim();
  return cleaned.split(/\s+/).filter(Boolean);
}

// Sort alphabetically
function sortEmails() {
  const emails = getCurrentEmails();
  emails.sort((a,b) => a.toLowerCase().localeCompare(b.toLowerCase()));
  showOutput(emails);
}

// Remove duplicates (preserve order)
function removeDuplicates() {
  const emails = getCurrentEmails();
  const seen = new Set();
  const unique = emails.filter(e => {
    const lower = e.toLowerCase();
    if (seen.has(lower)) return false;
    seen.add(lower);
    return true;
  });
  showOutput(unique);
}

// Show output in textarea
function showOutput(list) {
  document.getElementById('output').value = list.join('\n');
  document.getElementById('warning').textContent = `‚úÖ ${list.length} emails currently in output.`;
}

// Copy output to clipboard
async function copyOutput() {
  const output = document.getElementById('output').value;
  try {
    await navigator.clipboard.writeText(output);
    alert('‚úÖ Copied to clipboard!');
  } catch {
    alert('‚ö†Ô∏è Copy failed. Please copy manually.');
  }
}

// Clear output
function clearOutput() {
  document.getElementById('output').value = '';
  document.getElementById('warning').textContent = '‚úÖ Output cleared.';
}
</script>
</body>
</html>

